# AEGIS System Architecture

## Overall System Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AEGIS PLATFORM                               â”‚
â”‚                   Blockchain Disaster Relief                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DISASTER OCCURS    â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   ORACLE DETECTS     â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   FUNDS RELEASED     â”‚
â”‚  (Earthquake/Flood)  â”‚        â”‚  (Chainlink Node)    â”‚        â”‚  (Smart Contract)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                          â”‚
                                                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          TOKEN DISTRIBUTION LAYER                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚ Food Tokens  â”‚      â”‚Medical Tokensâ”‚      â”‚ Shelter      â”‚                    â”‚
â”‚    â”‚   (ID: 1)    â”‚      â”‚   (ID: 2)    â”‚      â”‚ Tokens       â”‚    + 2 more        â”‚
â”‚    â”‚   500 units  â”‚      â”‚   300 units  â”‚      â”‚ (ID: 4)      â”‚                    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      VICTIM WALLETS            â”‚
                    â”‚  (Zero-Knowledge Verified)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                  â”‚
                    â–¼                                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ONLINE PAYMENT     â”‚          â”‚  OFFLINE PAYMENT    â”‚
        â”‚  (Direct Transfer)  â”‚          â”‚  (QR/NFC Card)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                                  â”‚
                    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚         â”‚
                    â–¼         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   CATEGORY VALIDATION       â”‚
        â”‚  (CategoryManager SC)       â”‚
        â”‚                             â”‚
        â”‚  Food Token â†’ Grocery? âœ“    â”‚
        â”‚  Food Token â†’ Pharmacy? âœ—   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   MERCHANT RECEIVES         â”‚
        â”‚   Relief Tokens             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   INSTANT REDEMPTION        â”‚
        â”‚   (Atomic Swap)             â”‚
        â”‚                             â”‚
        â”‚   Burn Tokens â”€â”€â”           â”‚
        â”‚                 â”‚           â”‚
        â”‚   Transfer USDC â—€â”˜          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   MERCHANT RECEIVES         â”‚
        â”‚   USDC to Bank Account      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Smart Contract Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SMART CONTRACT LAYER                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AegisToken     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  (ERC-1155)     â”‚               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
            â”‚                         â”‚
            â”‚ validates               â”‚ mints tokens
            â”‚                         â”‚
            â–¼                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CategoryManager â”‚       â”‚ DisasterOracle  â”‚
    â”‚                 â”‚       â”‚ (Chainlink)     â”‚
    â”‚ - Merchants     â”‚       â”‚                 â”‚
    â”‚ - Categories    â”‚       â”‚ - USGS API      â”‚
    â”‚ - Whitelist     â”‚       â”‚ - Weather API   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ triggers
                                      â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AegisVault     â”‚       â”‚ Regional        â”‚
    â”‚                 â”‚       â”‚ Responders      â”‚
    â”‚ - USDC Reserve  â”‚       â”‚ List            â”‚
    â”‚ - Exchange Rate â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ - Atomic Swap   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–²
            â”‚ redeems tokens
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Merchants     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ MetaTx Relay    â”‚       â”‚ AegisPaymaster  â”‚
    â”‚                 â”‚       â”‚ (ERC-4337)      â”‚
    â”‚ - Offline Txs   â”‚       â”‚                 â”‚
    â”‚ - Signatures    â”‚       â”‚ - Gas Sponsor   â”‚
    â”‚ - Nonce Track   â”‚       â”‚ - User Whitelistâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–²                         â–²
            â”‚                         â”‚
            â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚          VICTIM TRANSACTIONS              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ZKIdentity      â”‚
    â”‚ Verifier        â”‚
    â”‚                 â”‚
    â”‚ - Merkle Root   â”‚
    â”‚ - ZK Proofs     â”‚
    â”‚ - Privacy       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–²
            â”‚ proves eligibility
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Disaster      â”‚
    â”‚  Victims       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## User Role Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ADMIN WORKFLOW                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    1. Deploy Contracts
         â”‚
         â–¼
    2. Configure Oracle
         â”‚
         â–¼
    3. Register Merchants â”€â”€â–¶ Verify Category
         â”‚
         â–¼
    4. Add Regional Responders
         â”‚
         â–¼
    5. Fund Vault with USDC
         â”‚
         â–¼
    6. Monitor Disasters â”€â”€â–¶ Manual Override if Needed


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VICTIM WORKFLOW                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    1. Disaster Occurs
         â”‚
         â–¼
    2. Submit ZK Proof â”€â”€â–¶ Identity Verified
         â”‚
         â–¼
    3. Receive Tokens (Auto-minted)
         â”‚
         â–¼
    4. Make Purchase:
         â”œâ”€â–¶ Online: Direct Transfer
         â””â”€â–¶ Offline: Show QR Code
              â”‚
              â–¼
    5. Merchant Validates Category
         â”‚
         â–¼
    6. Transaction Complete


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MERCHANT WORKFLOW                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    1. Register Business
         â”‚
         â–¼
    2. Get Verified by Admin
         â”‚
         â–¼
    3. Accept Relief Tokens:
         â”œâ”€â–¶ Scan QR Code (Offline)
         â””â”€â–¶ Accept Transfer (Online)
              â”‚
              â–¼
    4. Tokens Accumulate in Wallet
         â”‚
         â–¼
    5. Redeem for USDC (Anytime)
         â”‚
         â–¼
    6. Receive Instant Payment
         â”‚
         â–¼
    7. Withdraw to Bank Account
```

---

## Technical Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TECHNOLOGY STACK                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

BLOCKCHAIN LAYER
â”œâ”€â”€ Polygon (Layer 2)
â”‚   â”œâ”€â”€ Low gas fees
â”‚   â”œâ”€â”€ Fast transactions
â”‚   â””â”€â”€ EVM compatible
â”‚
â”œâ”€â”€ Smart Contracts
â”‚   â”œâ”€â”€ Solidity 0.8.20
â”‚   â”œâ”€â”€ OpenZeppelin libraries
â”‚   â””â”€â”€ Hardhat development

ORACLE LAYER
â”œâ”€â”€ Chainlink
â”‚   â”œâ”€â”€ External APIs
â”‚   â”œâ”€â”€ Price feeds
â”‚   â””â”€â”€ Automation

FRONTEND LAYER
â”œâ”€â”€ React 18
â”‚   â”œâ”€â”€ Component-based UI
â”‚   â”œâ”€â”€ Responsive design
â”‚   â””â”€â”€ Web3 integration

BACKEND SERVICES
â”œâ”€â”€ IPFS (Metadata)
â”œâ”€â”€ The Graph (Indexing)
â””â”€â”€ API Gateway

SECURITY
â”œâ”€â”€ Role-Based Access Control
â”œâ”€â”€ Zero-Knowledge Proofs
â”œâ”€â”€ Signature Verification
â””â”€â”€ Multi-sig Governance
```

---

## Data Flow: Complete Transaction

```
STEP 1: DISASTER DETECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Earthquake 6.5 magnitude
         â”‚
         â–¼
    [USGS API]
         â”‚
         â–¼
    [Chainlink Oracle] â”€â”€â–¶ requestDisasterData()
         â”‚
         â–¼
    [DisasterOracle.sol]
         â”‚
         â”œâ”€â–¶ magnitude >= 6.0? YES
         â”‚
         â””â”€â–¶ releaseFunds() â”€â”€â–¶ Auto-triggered


STEP 2: TOKEN MINTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [DisasterOracle]
         â”‚
         â–¼
    getRegionalResponders("REGION_A")
         â”‚
         â–¼
    [AegisToken.mintBatch()]
         â”‚
         â”œâ”€â–¶ 500 Food Tokens
         â”œâ”€â–¶ 300 Medical Tokens
         â”œâ”€â–¶ 200 Education Tokens
         â”œâ”€â–¶ 400 Shelter Tokens
         â””â”€â–¶ 250 Utilities Tokens
              â”‚
              â–¼
         [Victim Wallet]


STEP 3: VICTIM PURCHASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Victim wants food
         â”‚
         â–¼
    [Generate Transaction]
         â”‚
         â”œâ”€â–¶ ONLINE: Direct blockchain tx
         â”‚            â”‚
         â”‚            â–¼
         â”‚       [MetaMask signs]
         â”‚
         â””â”€â–¶ OFFLINE: Generate QR code
                      â”‚
                      â–¼
                 [Merchant scans]
                      â”‚
                      â–¼
                 [MetaTxRelay.executeMetaTransaction()]


STEP 4: CATEGORY VALIDATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [AegisToken.safeTransferFrom()]
         â”‚
         â–¼
    [CategoryManager.canReceiveToken()]
         â”‚
         â”œâ”€â–¶ Token ID: 1 (Food)
         â”œâ”€â–¶ Merchant Category: GROCERY
         â”‚
         â””â”€â–¶ Match? âœ“ YES
              â”‚
              â–¼
         Transfer Allowed


STEP 5: MERCHANT REDEMPTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [Merchant Dashboard]
         â”‚
         â–¼
    Click "Redeem for USDC"
         â”‚
         â–¼
    [AegisVault.redeemTokens()]
         â”‚
         â”œâ”€â–¶ Burn 150 Food Tokens
         â”‚
         â””â”€â–¶ Transfer 150 USDC (Atomic!)
              â”‚
              â–¼
         [Merchant Wallet]
              â”‚
              â–¼
         Off-ramp to bank


STEP 6: GASLESS EXECUTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    [Victim has no MATIC]
         â”‚
         â–¼
    [AegisPaymaster.validatePaymasterUserOp()]
         â”‚
         â”œâ”€â–¶ Is user sponsored? âœ“ YES
         â”œâ”€â–¶ Has sufficient deposit? âœ“ YES
         â”‚
         â””â”€â–¶ Pay gas fee on behalf
              â”‚
              â–¼
         [Transaction executes]
              â”‚
              â–¼
    [Paymaster.postOp()] â”€â”€â–¶ Deduct from deposit
```

---

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SECURITY LAYERS                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 1: ACCESS CONTROL
â”œâ”€â”€ Role-Based Permissions
â”‚   â”œâ”€â”€ ADMIN_ROLE â”€â”€â–¶ Configure system
â”‚   â”œâ”€â”€ MINTER_ROLE â”€â”€â–¶ Create tokens
â”‚   â”œâ”€â”€ REGISTRAR_ROLE â”€â”€â–¶ Verify merchants
â”‚   â””â”€â”€ OPERATOR_ROLE â”€â”€â–¶ Manage vault
â”‚
LAYER 2: TRANSACTION VALIDATION
â”œâ”€â”€ Signature Verification (ECDSA)
â”œâ”€â”€ Nonce Tracking (Replay prevention)
â”œâ”€â”€ Category Matching (Spend control)
â””â”€â”€ Balance Checks (Solvency)
â”‚
LAYER 3: PRIVACY PROTECTION
â”œâ”€â”€ Zero-Knowledge Proofs
â”‚   â”œâ”€â”€ Prove eligibility
â”‚   â”œâ”€â”€ Hide identity
â”‚   â””â”€â”€ Prevent doxxing
â”‚
LAYER 4: SMART CONTRACT SECURITY
â”œâ”€â”€ OpenZeppelin Libraries
â”œâ”€â”€ SafeERC20 (Reentrancy guard)
â”œâ”€â”€ Pausable (Emergency stop)
â””â”€â”€ Upgradeable (Future-proof)
â”‚
LAYER 5: ORACLE SECURITY
â”œâ”€â”€ Chainlink Decentralized Oracles
â”œâ”€â”€ Multiple data sources
â””â”€â”€ Threshold-based triggers
```

---

**System designed for reliability, security, and humanitarian impact! ğŸ›¡ï¸**
